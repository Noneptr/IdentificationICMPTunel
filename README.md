# Идентификация шифрофанного трафика в ICMP-туннеле

Пакет программ состоит из ICMP-клиента client.py, ICMP-эхо-сервера server.py и ICMP-снифера sniffer.py, который детектирует ICMP-туннель в сети.

Для корректной работы программ их необходимо запускать с правами суперпользователя.

1. Программа tunel-icmp клиент: client.py
2. Программа tunel-icmp сервер: server.py
3. Программа tunel-icmp сниффер-анализатор: sniffer.py

для получения справки по программам, запустить интересующую программу с ключом -h или --help:
    пример в Windows: `python client.py -h или python client.py --help`
    пример в Linux: `sudo python3 client.py -h или sudo python3 client.py --help`

Пример запуска программ на localhost в Windows:
    1) `python client.py 127.0.0.1 -la 127.0.0.1 -di`			// -di запускаем клиент с отправкой данных из ввода
    2) `python server.py -la 127.0.0.1`
    3) `python sniffer.py -la 127.0.0.1`

Для получения отладочной информации о типах передаваемых сообщений каждая из программ имеет опцию -d или --debug.
Например вывод sniffer.py без -d: `[23:49:36.916979] Possible tunnel detected: 127.0.0.1:0 --> 127.0.0.1`
Например вывод sniffer.py с -d: `[23:51:06.686116] [ICMP] {type: 8, code: 0} Possible tunnel detected: 127.0.0.1:8191 --> 127.0.0.1`


Заметка:
    -la или --listen_addr это ipv4 адрес прослушиваемого интерфейса
    Пример:
	Пусть компьютер находится в локальной сети 192.168.1.0/24 и имеет адрес 192.168.1.2.
        Если необходимо получать icmp-сообщения из данной сети то в качестве аргумента -la нужно указать 192.168.1.2

Заметка для client.py:
   -di или --data_inp запускаем клиент с отправкой данных из ввода
   -df или --data_file запускаем клиент с отправкой данных из файла 
   -dr или --data_rand запускаем клиент с отправкой случайных байтов данных


